# صفحة تفاصيل الطالب الشاملة

## 📋 نظرة عامة

تم إضافة صفحة تفاصيل شاملة للطالب تحتوي على جميع معلوماته المالية والأكاديمية مع إمكانية إدارة الأقساط والرسوم الإضافية.

## ✨ الميزات الجديدة

### 1. صفحة تفاصيل الطالب
- **المعلومات الأساسية**: عرض شامل لبيانات الطالب
- **الملخص المالي**: القسط الكلي، المدفوع، المتبقي، عدد الدفعات
- **واجهة سهلة الاستخدام**: تصميم احترافي ومنظم

### 2. إدارة الأقساط
- **عرض الأقساط المدفوعة**: جدول يعرض جميع الدفعات مع التاريخ والوقت الدقيق
- **إضافة أقساط جديدة**: 
  - منع إضافة مبلغ أكبر من المتبقي
  - تسجيل التاريخ والوقت الدقيق
  - إضافة ملاحظات اختيارية
- **حذف الأقساط**: إمكانية حذف الأقساط المدفوعة

### 3. إدارة الرسوم الإضافية
- **أنواع الرسوم المتاحة**:
  - رسوم التسجيل
  - الزي المدرسي
  - الكتب والقرطاسية
  - رسوم النقل والأنشطة
  - رسوم الامتحانات
  - رسوم مخصصة (يمكن تحديد النوع يدوياً)

- **إدارة الرسوم**:
  - إضافة رسوم جديدة مع تاريخ الاستحقاق
  - تسجيل حالة الدفع (مدفوع/غير مدفوع)
  - تسجيل تاريخ الدفع
  - حذف الرسوم
  - تحديث حالة الدفع

## 🚀 كيفية الاستخدام

### الوصول لصفحة التفاصيل
1. انتقل إلى صفحة "الطلاب" من القائمة الجانبية
2. ابحث عن الطالب المطلوب
3. اضغط على زر "تفاصيل" في عمود الإجراءات

### إضافة قسط جديد
1. في صفحة تفاصيل الطالب، اضغط على "إضافة قسط"
2. أدخل مبلغ القسط (لا يمكن أن يزيد عن المتبقي)
3. اختر تاريخ ووقت الدفعة
4. أضف ملاحظات إضافية إذا أردت
5. اضغط "حفظ القسط"

### إضافة رسم إضافي
1. في صفحة تفاصيل الطالب، اضغط على "إضافة رسم"
2. اختر نوع الرسم من القائمة المنسدلة
3. أدخل مبلغ الرسم
4. حدد تاريخ الاستحقاق
5. اختر حالة الدفع (إذا كان مدفوعاً)
6. أضف ملاحظات إضافية
7. اضغط "حفظ الرسم"

### دفع رسم إضافي
1. في جدول الرسوم الإضافية، ابحث عن الرسم غير المدفوع
2. اضغط على زر "دفع" في عمود الإجراءات
3. أكد العملية

## 🔧 الملفات الجديدة

### 1. صفحة التفاصيل
```
ui/pages/students/student_details_page.py
```
الصفحة الرئيسية لعرض تفاصيل الطالب الشاملة

### 2. نافذة إضافة القسط
```
ui/pages/students/add_installment_dialog.py
```
نافذة حوار لإضافة أقساط جديدة

### 3. نافذة إضافة الرسم الإضافي
```
ui/pages/students/add_additional_fee_dialog.py
```
نافذة حوار لإضافة رسوم إضافية جديدة

### 4. تحديث الواردات
```
ui/pages/students/__init__.py
```
تم تحديثه ليشمل الصفحات الجديدة

## 🛠 التحديثات على الملفات الموجودة

### 1. صفحة الطلاب الرئيسية
```
ui/pages/students/students_page.py
```
- تم تحديث دالة `show_student_details()` لفتح الصفحة الجديدة
- إضافة دوال للتنقل بين الصفحات

### 2. النافذة الرئيسية
```
app/main_window.py
```
- إضافة دوال `show_page_widget()` و `show_students_page()` لدعم التنقل

## 📊 تكامل قاعدة البيانات

### جدول الأقساط (installments)
- `id`: المعرف الفريد
- `student_id`: معرف الطالب
- `amount`: مبلغ القسط
- `payment_date`: تاريخ الدفعة
- `payment_time`: وقت الدفعة
- `paid_amount`: المبلغ المدفوع فعلياً
- `status`: حالة القسط
- `notes`: ملاحظات

### جدول الرسوم الإضافية (additional_fees)
- `id`: المعرف الفريد
- `student_id`: معرف الطالب
- `fee_type`: نوع الرسم
- `amount`: مبلغ الرسم
- `due_date`: تاريخ الاستحقاق
- `paid`: حالة الدفع (صحيح/خطأ)
- `payment_date`: تاريخ الدفع
- `status`: حالة الرسم
- `notes`: ملاحظات

## 🎨 التصميم

- **واجهة احترافية**: ألوان متناسقة وتصميم عصري
- **تخطيط مرن**: يتكيف مع أحجام الشاشات المختلفة
- **تنقل سهل**: أزرار واضحة للتنقل والعمليات
- **رسائل تفاعلية**: تأكيدات وتحذيرات واضحة

## ⚠️ ملاحظات مهمة

1. **الحماية من الأخطاء**: لا يمكن إضافة قسط أكبر من المتبقي
2. **تسجيل دقيق**: يتم تسجيل التاريخ والوقت الدقيق لكل عملية
3. **مرونة في الرسوم**: يمكن إضافة أنواع رسوم مخصصة
4. **سهولة الإدارة**: عمليات بسيطة لإضافة وحذف وتحديث البيانات

## 🧪 الاختبار

لاختبار الميزة الجديدة:
```bash
python test_student_details.py
```

## 📝 سجل التغييرات

- ✅ إضافة صفحة تفاصيل الطالب الشاملة
- ✅ إدارة الأقساط مع منع التجاوز
- ✅ إدارة الرسوم الإضافية
- ✅ واجهة مستخدم محسنة
- ✅ تكامل مع قاعدة البيانات الموجودة
- ✅ معالجة الأخطاء والتحقق من صحة البيانات
